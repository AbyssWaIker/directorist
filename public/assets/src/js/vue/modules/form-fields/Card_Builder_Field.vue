<template>
  <div class>
    <div class="cptm-builder-section">
      <!-- cptm-preview-area -->
      <div class="cptm-preview-area">
        <div class="cptm-card-preview-widget">
          <!-- cptm-listing-card-preview-header -->
          <div class="cptm-listing-card-preview-header">
            <div class="cptm-card-preview-thumbnail">
              <div class="cptm-card-preview-thumbnail-overlay">

                <!-- cptm-card-preview-top-left -->
                <div class="cptm-card-preview-top-left">
                  <div class="cptm-card-preview-top-left-placeholder cptm-placeholder-blcok">
                    <p class="cptm-placeholder-label">Top Left</p>

                    <div class="cptm-widget-insert-area">
                      <div class="cptm-widget-insert-wrap">
                        <div class="cptm-widget-insert-modal-container">
                          <div class="cptm-option-card cptm-animation-slide-up">
                            <div class="cptm-option-card-header">
                              <div class="cptm-option-card-header-title-section">
                                <h3 class="cptm-option-card-header-title">Insert Element</h3>

                                <div class="cptm-header-action-area">
                                  <a
                                    href="#"
                                    class="cptm-header-action-link cptm-header-action-close"
                                  >
                                    <span class="fa fa-times"></span>
                                  </a>
                                </div>
                              </div>

                              <div class="cptm-option-card-header-nav-section">
                                <ul class="cptm-option-card-header-nav">
                                  <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                                  <li class="cptm-option-card-header-nav-item">Custom Field</li>
                                </ul>
                              </div>
                            </div>

                            <div class="cptm-option-card-body">Options</div>

                            <span class="cptm-anchor-down"></span>
                          </div>
                        </div>

                        <a href="#" class="cptm-widget-insert-link">
                          <span class="fa fa-plus"></span>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- cptm-card-preview-top-rignt -->
                <div class="cptm-card-preview-top-rignt">
                  <div class="cptm-card-preview-top-rignt-placeholder cptm-placeholder-blcok">
                    <p class="cptm-placeholder-label hide">Top Rignt</p>

                    <div class="cptm-widget-insert-area">
                      <div class="cptm-widget-insert-wrap">
                        <div class="cptm-widget-insert-modal-container">
                          <div class="cptm-option-card cptm-animation-slide-up">
                            <div class="cptm-option-card-header">
                              <div class="cptm-option-card-header-title-section">
                                <h3 class="cptm-option-card-header-title">Insert Element</h3>

                                <div class="cptm-header-action-area">
                                  <a
                                    href="#"
                                    class="cptm-header-action-link cptm-header-action-close"
                                  >
                                    <span class="fa fa-times"></span>
                                  </a>
                                </div>
                              </div>

                              <div class="cptm-option-card-header-nav-section">
                                <ul class="cptm-option-card-header-nav">
                                  <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                                  <li class="cptm-option-card-header-nav-item">Custom Field</li>
                                </ul>
                              </div>
                            </div>

                            <div class="cptm-option-card-body">Options</div>

                            <span class="cptm-anchor-down"></span>
                          </div>
                        </div>

                        <a href="#" class="cptm-widget-insert-link">
                          <span class="fa fa-plus"></span>
                        </a>
                      </div>
                    </div>

                    <div class="cptm-widget-badge">Badge Text</div>
                    <!-- <div class="cptm-widget-badge">Badge Text 2</div> -->
                  </div>
                </div>
                
                <!-- cptm-card-preview-bottom-left -->
                <div class="cptm-card-preview-bottom-left">
                  <div class="cptm-card-preview-bottom-left-placeholder cptm-placeholder-blcok">
                    <p class="cptm-placeholder-label">Bottom Left</p>

                    <div class="cptm-widget-insert-area">
                      <div class="cptm-widget-insert-wrap">
                        <div class="cptm-widget-insert-modal-container">
                          <div class="cptm-option-card cptm-animation-slide-up">
                            <div class="cptm-option-card-header">
                              <div class="cptm-option-card-header-title-section">
                                <h3 class="cptm-option-card-header-title">Insert Element</h3>

                                <div class="cptm-header-action-area">
                                  <a
                                    href="#"
                                    class="cptm-header-action-link cptm-header-action-close"
                                  >
                                    <span class="fa fa-times"></span>
                                  </a>
                                </div>
                              </div>

                              <div class="cptm-option-card-header-nav-section">
                                <ul class="cptm-option-card-header-nav">
                                  <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                                  <li class="cptm-option-card-header-nav-item">Custom Field</li>
                                </ul>
                              </div>
                            </div>

                            <div class="cptm-option-card-body">Options</div>

                            <span class="cptm-anchor-down"></span>
                          </div>
                        </div>

                        <a href="#" class="cptm-widget-insert-link">
                          <span class="fa fa-plus"></span>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- cptm-card-preview-bottom-rignt -->
                <div class="cptm-card-preview-bottom-rignt">
                  <div class="cptm-card-preview-bottom-rignt-placeholder cptm-placeholder-blcok">
                    <p class="cptm-placeholder-label">Bottom Rignt</p>

                    <div class="cptm-widget-insert-area">
                      <div class="cptm-widget-insert-wrap">
                        <div class="cptm-widget-insert-modal-container">
                          <div class="cptm-option-card cptm-animation-slide-up">
                            <div class="cptm-option-card-header">
                              <div class="cptm-option-card-header-title-section">
                                <h3 class="cptm-option-card-header-title">Insert Element</h3>

                                <div class="cptm-header-action-area">
                                  <a
                                    href="#"
                                    class="cptm-header-action-link cptm-header-action-close"
                                  >
                                    <span class="fa fa-times"></span>
                                  </a>
                                </div>
                              </div>

                              <div class="cptm-option-card-header-nav-section">
                                <ul class="cptm-option-card-header-nav">
                                  <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                                  <li class="cptm-option-card-header-nav-item">Custom Field</li>
                                </ul>
                              </div>
                            </div>

                            <div class="cptm-option-card-body">Options</div>

                            <span class="cptm-anchor-down"></span>
                          </div>
                        </div>

                        <a href="#" class="cptm-widget-insert-link">
                          <span class="fa fa-plus"></span>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="cptm-card-preview-thumbnail-bg">
                    <span class="fa fa-picture-o"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- cptm-listing-card-preview-body -->
          <div class="cptm-listing-card-preview-body">
            <div class="cptm-listing-card-preview-body-placeholder cptm-placeholder-blcok">
              <p class="cptm-placeholder-label">Body Contents</p>

              <div class="cptm-widget-insert-area">
                <div class="cptm-widget-insert-wrap">
                  <div class="cptm-widget-insert-modal-container">
                    <div class="cptm-option-card active cptm-animation-slide-up">
                      <div class="cptm-option-card-header">
                        <div class="cptm-option-card-header-title-section">
                          <h3 class="cptm-option-card-header-title">Insert Element</h3>

                          <div class="cptm-header-action-area">
                            <a href="#" class="cptm-header-action-link cptm-header-action-close">
                              <span class="fa fa-times"></span>
                            </a>
                          </div>
                        </div>

                        <div class="cptm-option-card-header-nav-section">
                          <ul class="cptm-option-card-header-nav">
                            <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                            <li class="cptm-option-card-header-nav-item">Custom Field</li>
                          </ul>
                        </div>
                      </div>

                      <div class="cptm-option-card-body">Options</div>

                      <span class="cptm-anchor-down"></span>
                    </div>
                  </div>

                  <a href="#" class="cptm-widget-insert-link">
                    <span class="fa fa-plus"></span>
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- cptm-listing-card-preview-footer -->
          <div class="cptm-listing-card-preview-footer">
            <!-- cptm-listing-card-preview-footer-left-placeholder -->
            <div class="cptm-listing-card-preview-footer-left-placeholder cptm-placeholder-blcok">
              <p class="cptm-placeholder-label">Footer Left</p>
              <div class="cptm-widget-insert-area">
                <div class="cptm-widget-insert-wrap">
                  <div class="cptm-widget-insert-modal-container">
                    <div class="cptm-option-card cptm-animation-slide-up">
                      <div class="cptm-option-card-header">
                        <div class="cptm-option-card-header-title-section">
                          <h3 class="cptm-option-card-header-title">Insert Element</h3>

                          <div class="cptm-header-action-area">
                            <a href="#" class="cptm-header-action-link cptm-header-action-close">
                              <span class="fa fa-times"></span>
                            </a>
                          </div>
                        </div>

                        <div class="cptm-option-card-header-nav-section">
                          <ul class="cptm-option-card-header-nav">
                            <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                            <li class="cptm-option-card-header-nav-item">Custom Field</li>
                          </ul>
                        </div>
                      </div>

                      <div class="cptm-option-card-body">Options</div>

                      <span class="cptm-anchor-down"></span>
                    </div>
                  </div>

                  <a href="#" class="cptm-widget-insert-link">
                    <span class="fa fa-plus"></span>
                  </a>
                </div>
              </div>
            </div>
            
            
            <!-- cptm-listing-card-preview-footer-right-placeholder -->
            <div class="cptm-listing-card-preview-footer-right-placeholder cptm-placeholder-blcok">
              <p class="cptm-placeholder-label">Footer Right</p>

              <div class="cptm-widget-insert-area">
                <div class="cptm-widget-insert-wrap">
                  <div class="cptm-widget-insert-modal-container">
                    <div class="cptm-option-card cptm-animation-slide-up">
                      <div class="cptm-option-card-header">
                        <div class="cptm-option-card-header-title-section">
                          <h3 class="cptm-option-card-header-title">Insert Element</h3>

                          <div class="cptm-header-action-area">
                            <a href="#" class="cptm-header-action-link cptm-header-action-close">
                              <span class="fa fa-times"></span>
                            </a>
                          </div>
                        </div>

                        <div class="cptm-option-card-header-nav-section">
                          <ul class="cptm-option-card-header-nav">
                            <li class="cptm-option-card-header-nav-item active">Preset Field</li>
                            <li class="cptm-option-card-header-nav-item">Custom Field</li>
                          </ul>
                        </div>
                      </div>

                      <div class="cptm-option-card-body">Options</div>

                      <span class="cptm-anchor-down"></span>
                    </div>
                  </div>

                  <a href="#" class="cptm-widget-insert-link">
                    <span class="fa fa-plus"></span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="cptm-options-area">
        <div class="cptm-option-card active cptm-animation-flip">
          <div class="cptm-option-card-header">
            <div class="cptm-option-card-header-title-section">
              <h3 class="cptm-option-card-header-title">Widget Settings</h3>

              <div class="cptm-header-action-area">
                <a href="#" class="cptm-header-action-link cptm-header-action-close">
                  <span class="fa fa-times"></span>
                </a>
              </div>
            </div>
          </div>

          <div class="cptm-option-card-body">Options</div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: "card-builder",
  props: [],

  created() {
    // console.log( this.output_data );
  },

  computed: {
    output_data() {
      let output = {};
      let layout = JSON.parse(JSON.stringify(this.layout));

      for (let section in layout) {
        output[section] = {};

        if (typeof layout[section] !== "object") {
          continue;
        }

        for (let section_area in layout[section]) {
          output[section][section_area] = [];

          if (typeof layout[section][section_area] !== "object") {
            continue;
          }
          if (typeof layout[section][section_area].widgets !== "object") {
            continue;
          }

          for (let widget in layout[section][section_area].widgets) {
            const widget_name = layout[section][section_area].widgets[widget];

            if (typeof this.active_widgets[widget_name] !== "object") {
              continue;
            }
            if (typeof this.active_widgets[widget_name].options !== "object") {
              continue;
            }

            let widget_options = this.active_widgets[widget_name].options;
            let widget_options_data = {};

            if (typeof this.active_widgets[widget_name].type !== "undefined") {
              widget_options_data["type"] = this.active_widgets[
                widget_name
              ].type;
            }

            if (typeof this.active_widgets[widget_name].id !== "undefined") {
              widget_options_data["id"] = this.active_widgets[widget_name].id;
            }

            for (let option in widget_options) {
              widget_options_data[option] = widget_options[option].value;
            }

            output[section][section_area].push(widget_options_data);
          }
        }
      }

      return output;
    },
  },

  data() {
    return {
      widgets: {
        listing_title: {
          type: "title",
          id: "listing_title",
          label: "Listing Title",
          icon: "",
          options: {
            label: {
              type: "text",
              label: "Label",
              value: "text",
            },
          },
        },

        open_now_badge: {
          type: "badge",
          id: "open_now_badge",
          label: "Badge",
          icon: "",
          options: {
            label: {
              type: "text",
              label: "Label",
              value: "Open Now",
            },
          },
        },

        favorite_badge: {
          type: "badge",
          id: "favorite_badge",
          label: "Favorite",
          icon: "",
          options: {
            icon: {
              type: "icon",
              label: "Icon",
              value: "fa fa-heart",
            },
          },
        },

        category: {
          type: "category",
          id: "category",
          label: "Category",
          icon: "",
          options: {
            icon: {
              type: "icon",
              label: "Icon",
              value: "fa fa-folder",
            },
          },
        },

        user_avater: {
          type: "avater",
          id: "user_avater",
          label: "User Avater",
          icon: "",
          options: {
            align: {
              type: "select",
              label: "Align",
              value: "center",
            },
          },
        },
      },

      active_widgets: {
        listing_title: {
          type: "title",
          id: "listing_title",
          label: "Listing Title",
          icon: "",
          options: {
            label: {
              type: "text",
              label: "Label",
              value: "text",
            },
          },
        },

        open_now_badge: {
          type: "badge",
          id: "open_now_badge",
          label: "Badge",
          icon: "",
          options: {
            label: {
              type: "text",
              label: "Label",
              value: "Open Now",
            },
          },
        },

        favorite_badge: {
          type: "badge",
          id: "favorite_badge",
          label: "Favorite",
          icon: "",
          options: {
            icon: {
              type: "icon",
              label: "Icon",
              value: "fa fa-heart",
            },
          },
        },

        category: {
          type: "category",
          id: "category",
          label: "Category",
          icon: "",
          options: {
            icon: {
              type: "icon",
              label: "Icon",
              value: "fa fa-folder",
            },
          },
        },

        user_avater: {
          type: "avater",
          id: "user_avater",
          label: "User Avater",
          icon: "",
          options: {
            align: {
              type: "select",
              label: "Align",
              value: "center",
            },
          },
        },
      },

      layout: {
        thumbnail: {
          top_right: {
            max_widget: 2,
            max_widget_info_text: "Up to 2 items can be added",
            accepted_widgets: ["open_now_badge", "favorite_badge"],
            widgets: ["open_now_badge", "favorite_badge"],
          },
          top_left: {
            max_widget: 2,
            max_widget_info_text: "Up to 2 items can be added",
            accepted_widgets: ["open_now_badge", "favorite_badge"],
            widgets: ["favorite_badge", "favorite_badge"],
          },
          bottom_right: {
            max_widget: 2,
            max_widget_info_text: "Up to 2 items can be added",
            accepted_widgets: ["open_now_badge", "favorite_badge"],
            widgets: ["open_now_badge", "favorite_badge"],
          },
          bottom_left: {
            max_widget: 2,
            max_widget_info_text: "Up to 2 items can be added",
            accepted_widgets: ["open_now_badge", "favorite_badge"],
            widgets: ["open_now_badge", "favorite_badge"],
          },
          avater: {
            max_widget: 1,
            max_widget_info_text: "Up to 1 item can be added",
            accepted_widgets: ["user_avater"],
            widgets: ["user_avater"],
          },
        },

        body: {
          header: {
            max_widget: 2,
            accepted_widgets: [
              { label: "Preset", widgets: ["listing_title"] },
              { label: "Custom", widgets: ["listing_title"] },
            ],
            widgets: ["listing_title"],
          },
        },

        footer: {
          right: {
            max_widget: 2,
            accepted_widgets: ["category"],
            widgets: ["category"],
          },
          left: {
            max_widget: 2,
            accepted_widgets: ["category"],
            widgets: ["category"],
          },
        },
      },
    };
  },

  methods: {},
};
</script>